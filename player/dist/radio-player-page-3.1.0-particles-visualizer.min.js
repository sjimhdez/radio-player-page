const s={PARTICLE_COUNT:50,PARTICLE_COLOR:"rgba(19, 181, 210, 0.78)",PARTICLE_SIZE:2,MIN_RADIUS_PERCENT:.05,MAX_RADIUS_PERCENT:.45,ORBIT_SPEED:.03,SMOOTHING_FACTOR:.25,TRAIL_LENGTH:60,TRAIL_OPACITY:.3,SENSITIVITY_MULTIPLIER:2.5},A=new WeakMap;function P(n,t,i){n.width=t,n.height=i;const R=t/2,o=i/2,a=Math.min(t,i),e=a*s.MIN_RADIUS_PERCENT,E=a*s.MAX_RADIUS_PERCENT,r=[],l=Math.PI*2/s.PARTICLE_COUNT;for(let I=0;I<s.PARTICLE_COUNT;I++){const d=I*l,c=Math.floor(I/s.PARTICLE_COUNT*1024),T=I/s.PARTICLE_COUNT,u=e+(E-e)*T;r.push({angle:d,baseRadius:u,currentRadius:u,targetRadius:u,speed:s.ORBIT_SPEED*(.7+Math.random()*.6),trail:[],frequencyIndex:c})}return{particles:r,canvasWidth:t,canvasHeight:i,centerX:R,centerY:o}}function C(n,t,i,R){const o=n.length-1,a=Math.min(i,R),e=a*s.MIN_RADIUS_PERCENT,r=a*s.MAX_RADIUS_PERCENT-e;for(const l of t){const I=Math.min(l.frequencyIndex,o),c=n[I]/255,T=Math.min(1,c*s.SENSITIVITY_MULTIPLIER),_=T*T*r;l.targetRadius=l.baseRadius+_}}function m(n,t){return n+(t-n)*s.SMOOTHING_FACTOR}function L(n,t,i,R){const o=i+Math.cos(t.angle)*t.currentRadius,a=R+Math.sin(t.angle)*t.currentRadius;if(t.trail.push({x:o,y:a}),t.trail.length>s.TRAIL_LENGTH&&t.trail.shift(),t.trail.length>1){n.strokeStyle=s.PARTICLE_COLOR,n.lineWidth=s.PARTICLE_SIZE,n.globalAlpha=s.TRAIL_OPACITY,n.beginPath(),n.moveTo(t.trail[0].x,t.trail[0].y);for(let e=1;e<t.trail.length;e++)n.lineTo(t.trail[e].x,t.trail[e].y);n.stroke()}n.globalAlpha=1,n.fillStyle=s.PARTICLE_COLOR,n.beginPath(),n.arc(o,a,s.PARTICLE_SIZE,0,Math.PI*2),n.fill()}const M=(n,t,i,R,o)=>{let a=A.get(i);(!a||a.canvasWidth!==R||a.canvasHeight!==o)&&(a=P(i,R,o),A.set(i,a)),a.centerX=R/2,a.centerY=o/2,C(t,a.particles,R,o),n.clearRect(0,0,R,o);for(const e of a.particles)e.currentRadius=m(e.currentRadius,e.targetRadius),e.angle+=e.speed,e.angle>Math.PI*2&&(e.angle-=Math.PI*2),L(n,e,a.centerX,a.centerY)};export{M as particlesVisualizer};
